; Exercise 3 (i)

BEGIN:
	LDA 2000H
	MVI C,00H  
	MVI B,00H  ; THESIS COUNTER
	CPI 00H    ; IF ENTRY IS 0 
	JZ BEGIN   ; => REPEAT

LABEL:
	INR B
	MOV D,A    ; SAVE A
	MOV A,B   
	CPI 09H    ; IF B >= 9 THEN
	JNC LAST   ; MOVE TO LAST FLAG
	MOV A,D    ; RESTORE A
	RAL	    ; LEFT ROTATION
	JC FLAG    ; IF B < 9 THEN MOVE TO FLAG
	JMP LABEL  ; JUMP TO LABEL

FLAG:
	CALL DO_FLAG  ; CALL SUBROUTINE
	CALL SAVE     ; CALL SUBROUTINE

LAST:
	CALL EXIT  ; CALL SUBROUTINE
	JMP BEGIN  ; JUMP TO START

; CREATE CARRIER

CAR:
	MOV D,A    ; SAVE A
	MVI A,01H  ; LOAD 1
	CPI 05H    ; A - 5
	MOV A,D    ; SAVE D
	RET        ; STOP SUBROUTINE

; PUSS IN EXIT

SAVE:
	MOV D,A    ; SAVE A
	MOV A,C    ; SAVE C
	CMA        ; COMPLEMENT OF A
	STA 3000H  ; A IS STORED IN 3000H
	MOV A,D    ; SAVE A
	RET        ; STOP SUBROUTINE

; SUBROUTINE EDIT C

DO_FLAG:
	MOV D,A    ; SAVE A
	MOV A,C    ; SAVE C
	CALL CAR   ; CALL SUBROUTINE ONE
	RAR        ; MOVE RIGHT
	MOV C,A    ; SAVE A
	MOV A,D    ; SAVE D IN A
	DCR B      ; B <- B - 1
	JNZ DO_FLAG ; IF CY = 0, JUMP TO DO_C
	RET        ; STOP SUBROUTINE 

; SUBROUTINE EDIT EXIT (DIP SWITCH=OFF)
	
EXIT:
	LDA 2000H  ; MOVE THE INDEX OF 2000H IN A
	CPI 00H    ; IF A <> 0
	JNZ END0   ; JUMP TO END
	MVI A,FFH  ; 2's COMPLEMENT IS -1
	STA 3000H  ; MOVE A IN 3000H

END0:
	RET        ; STOP SUBROUTINE
END

































