;  Exercise 3 (ii)

	
BEGIN:
	LXI B,A2C2H ; BC <- 41666
	MVI D,04H ; D <- 4
	CALL KIND ; A <- ENTRY - READ KEYWORD
	ADI 00H   ; IF A = 0 
	JZ BEGIN  ; READ AGAIN - JUMP TO START
	CPI 09H   ; IF A >= 9 
	JNC BEGIN ; READ AGAIN - JUMP TO START
	CPI 05H   ; IF A >=5
	JNC MOVE_MSB   ; JUMP TO MSB
	MVI E,F0H
	JMP MOVE_LSB
MOVE_MSB:
	MVI E,0FH
MOVE_LSB:
	CALL EXIT
	JMP BEGIN
EXIT:
	MOV A,E
	STA 3000H
	CALL DELAY
	MVI A,FFH
	STA 3000H
	CALL DELAY
	DCR D
	JZ BEGIN
	JMP EXIT

;DELAY SUBROUTINE - DELAY = 12(BC-1) + 15.5 ÏSEC 

DELAY:
	DCX B     ; 6 STATES
	MOV A,B   ; 4 STATES
	ORA C     ; 4 STATES
	JNZ DELAY ;7/10 STATES
	RET       ; 10 STATES

END