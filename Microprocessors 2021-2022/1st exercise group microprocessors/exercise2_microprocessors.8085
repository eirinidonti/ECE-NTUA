  IN 10H       ; NO MEMORY SAFE
  LXI B,01F4H  ; BC <- 500 FOR DELB DELAY
  MVI A,FEH    ; LED STARTING THESIS

EXIT:
  STA 3000H    ; STORE IN EXIT PORT 
  MOV D,A      ; D IN PREVIOUS LED POSITION

START:
  CALL DELB    ; 0.5ms DELAY
  LDA 2000H    ; SAVE A
  ANI 03H      ; KEEP VALUES OF 2 LSBs
  CPI 01H      ; {X = (A) - 01} IF X = 0 => Z = 1 
  JZ  LEFT     ; MOVE LEFT

RETURN:
  CPI 00H      ; IF {A = 00} => Z=1
  JZ LEFT_ROTATION
  MVI A,FEH    ; LED TO INITIAL STATE
  STA 3000H    ; STORE IN EXIT PORT 
  JMP START    ; BEGIN

LEFT:
  MOV A,D       ; A IN PREVIOUS LED POSITION
  CPI 7FH       ; IF LED IS TO MSB
  JZ RIGHT      ; MOVE RIGHT
  RLC           ; A INDEX MOVE 1 THESIS LEFT
  JMP EXIT    

RIGHT:
  MOV A,D       ; A IN PREVIOUS LED POSITION
  CPI FEH       ; IF LED IS IN LSB
  JZ LEFT       ; MOVE LEFT
  RRC           ; A INDEX MOVE 1 THESIS RIGHT
  STA 3000H     ; STORE IN EXIT PORT 
  MOV D,A       ; D IN PREVIOUS LED POSITION
  CALL DELB     ; 0.5ms DELAY
  LDA 2000H     ; SAVE A
  ANI 03H       ; KEEP VALUES OF 2 LSBs
  CPI 01H       ; {X = (A) - 01} IF X = 0 => Z = 1
  JZ  RIGHT     ; MOVE RIGHT
  JMP RETURN    ; RETURN

LEFT_ROTATION:
  MOV A,D       ; A IN PREVIOUS LED POSITION
  RLC           ; A INDEX MOVE 1 THESIS LEFT
  JMP EXIT

END

